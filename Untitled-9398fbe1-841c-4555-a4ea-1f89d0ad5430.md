# 入栈和出栈顺序问题

Reviewed: No
Status: 基础
频率: ⭐

# 例题：

已知入栈序列为：1 2 3 4 5，这5个数依次入栈，出栈顺序、时机任意。 则下列可能的出栈序列不正确的是（）

 A 1 2 3 4 5

 B 3 2 1 5 4

 C 1 5 4 3 2

 D 4 3 5 1 2

# 规律解法

已知栈的输入序列是1,2,3,…,n，输出序列是a1,a2,…ai,…,an。

然后我们任选一个数ai，并筛选ai到an之间所有<=ai的元素，则它们一定是按照从大到小的顺序排列的。

（“从大到小“不一定紧紧相邻，只代表相对位置关系，比如(…，10，…，7，…，3，…，1，…）

举例：
入栈顺序：1 2 3 4 5 【n=5】
出栈顺序：3 2 1 5 4

验证：
让i=1，那么ai=3,后面小于3的有2,1。刚好3,2,1是按照从大到小的顺序排列的
让i=2，那么ai=2,后面小于2的有1。刚好2,1是按照从大到小的顺序排列的
让i=3，那么ai=1,后面小于1的有NULL，满足。
让i=4，那么ai=5,后面小于5的有4。刚好5,4是按照从大到小的顺序排列的
让i=5，那么ai=4,后面小于4的有NULL，满足。

如果入栈的序列是不规则的，那么就可以给他们一个从小到大的下标，然后对下标进行操作。

# 原理

最理想的情况下，从小到大入栈，从大到小出栈，但是因为出栈是随机的，也就是在入栈还没结束的情况下就可以出栈。这样，就会出现一些小的数提前出栈的现象。但是那些“守规矩”的小数相对位置是没有变化的。比如入栈12345，结果在4入栈之前3不听话先出去了。但是这不会影响12的顺序，12的相对顺序还是保持着 12入栈，21出栈。因为12是守规矩的。

[https://blog.csdn.net/u014424628/article/details/49718901](https://blog.csdn.net/u014424628/article/details/49718901)